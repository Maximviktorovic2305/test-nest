# Система бронирования событий

Масштабируемая backend-система для бронирования событий, построенная на NestJS, Prisma и MySQL.

## Возможности

- **Аутентификация**: Аутентификация на основе JWT с управлением доступом на основе ролей
- **Управление событиями**: Операции CRUD для событий
- **Система бронирования**: Отслеживание и управление доступностью мест
- **Безопасность**: Ограничение частоты запросов, проверка входных данных и глобальная обработка исключений
- **Документация**: Документация API Swagger
- **Логирование**: Асинхронное логирование с помощью Winston
- **Тестирование**: Модульные и интеграционные тесты

## Стек технологий

- **Фреймворк**: NestJS v11 + TypeScript
- **База данных**: MySQL с Prisma ORM
- **Аутентификация**: JWT через `@nestjs/jwt` и Passport
- **Валидация**: `class-validator` + `class-transformer`
- **Логирование**: Winston
- **Ограничение частоты запросов**: `@nestjs/throttler`
- **Документация API**: Swagger/OpenAPI через `@nestjs/swagger`
- **Тестирование**: Jest + Supertest

## Настройка

1. Установите зависимости:
   ```bash
   npm install
   ```

2. Запустите базу данных и Redis:
   ```bash
   docker-compose up -d
   ```

3. Сгенерируйте клиент Prisma:
   ```bash
   npm run prisma:generate
   ```

4. Запустите миграции базы данных:
   ```bash
   npm run prisma:migrate
   ```

5. Запустите сервер разработки:
   ```bash
   npm run start:dev
   ```

6. Доступ к документации API:
   Откройте `http://localhost:3000/api` в вашем браузере

## Конечные точки API

### Аутентификация
- `POST /auth/register` - Регистрация пользователя
- `POST /auth/login` - Вход пользователя

### События
- `POST /events` - Создание события (только для администратора)
- `GET /events` - Список всех событий
- `GET /events/:id` - Получение деталей события
- `PATCH /events/:id` - Обновление события (только для администратора)
- `DELETE /events/:id` - Удаление события (только для администратора)

### Бронирования
- `POST /bookings` - Создание бронирования
- `GET /bookings` - Список бронирований пользователя (или всех для администратора)
- `GET /bookings/:id` - Получение деталей бронирования
- `DELETE /bookings/:id` - Отмена бронирования

### Система
- `GET /` - Приветственное сообщение
- `GET /health` - Проверка состояния
- `GET /api` - Документация Swagger

## Тестирование

- Модульные тесты: `npm run test`
- Режим наблюдения: `npm run test:watch`
- Покрытие: `npm run test:cov`
- E2E тесты: `npm run test:e2e`
